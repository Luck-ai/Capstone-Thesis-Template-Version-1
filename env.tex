\usepackage{fontspec}
\setmainfont{TH SarabunPSK}

\fontsize{16pt}{19.2pt}\selectfont

\usepackage{amsmath, amssymb}
\usepackage{enumitem}
\usepackage{indentfirst}

\usepackage{geometry}
\geometry{
    a4paper,
    left=1.5in,
    right=1in,
    top=1in,
    bottom=1in
}

\usepackage{graphicx}
% Set default graphics search path for project images
\graphicspath{{images/}}
\usepackage{float}
\usepackage{caption}

% \captionsetup[table]{labelsep=space,justification=centering,font=bf}
% \captionsetup[figure]{labelsep=space,justification=centering,font=bf}

% Headers and spacing
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\rhead{\thepage}
\renewcommand{\headrulewidth}{0pt}
\usepackage{setspace}
\onehalfspacing

% Section title formatting
\usepackage{titlesec}

\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{3}

\titleformat{\chapter}[display]
  {\normalfont\bfseries\centering\fontsize{18}{22}\selectfont}
  {\MakeUppercase{\chaptertitlename\ \thechapter}}
  {1pt}
  {\fontsize{18}{22}\selectfont}

\titlespacing*{\chapter}{0pt}{0pt}{0pt}

\titleformat{\section}
  {\normalfont\bfseries\fontsize{16}{20}\selectfont}
  {\thesection}
  {1em}
  {\fontsize{16}{20}\selectfont}
\titlespacing*{\section}{0pt}{1em}{0pt}

\titleformat{\subsection}
  {\normalfont\bfseries\fontsize{16}{20}\selectfont}
  {\hspace{1in}\thesubsection}
  {1em}
  {\fontsize{16}{20}\selectfont}
\titlespacing*{\subsection}{0pt}{0pt}{0pt}

\titleformat{\subsubsection}
  {\normalfont\bfseries\fontsize{16}{20}\selectfont}
  {\hspace{1.5in}\thesubsubsection}
  {1em}
  {\fontsize{16}{20}\selectfont}
\titlespacing*{\subsubsection}{0pt}{0pt}{0pt}

% Table of contents formatting
\usepackage{tocloft}

% Customize TOC title and center it
\renewcommand{\contentsname}{TABLE OF CONTENTS}
\renewcommand{\cfttoctitlefont}{\hfill\bfseries\Large}
\renewcommand{\cftaftertoctitle}{\hfill}

% Format chapter entries as "CHAPTER <n> <TITLE>"
\renewcommand{\cftchappresnum}{CHAPTER\ }
\renewcommand{\cftchapaftersnum}{}
\setlength{\cftchapnumwidth}{4em} % reduced width so title sits closer to number

% Format chapters with bold font and ensure proper spacing
\renewcommand{\cftchapfont}{\bfseries}
\renewcommand{\cftchappagefont}{\bfseries}
\renewcommand{\cftchapleader}{\cftdotfill{\cftdotsep}}

% Make dots closer together in TOC
\renewcommand{\cftdotsep}{0.5}

% Sections: normal font weight
\renewcommand{\cftsecfont}{\normalfont}
\renewcommand{\cftsecpagefont}{\normalfont}

% Adjust widths and indents to match the layout
\setlength{\cftchapnumwidth}{4em} % reduced width so title sits closer to number
\setlength{\cftsecindent}{1.5em}
\setlength{\cftsecnumwidth}{2.5em}
\setlength{\cftsubsecindent}{4em}
\setlength{\cftsubsecnumwidth}{3.5em}
\setlength{\cftsubsubsecindent}{7.5em}
\setlength{\cftsubsubsecnumwidth}{4.5em}

% Numbering
\numberwithin{equation}{chapter}

% Force paragraph indentation
\setlength{\parindent}{1in}
\setlength{\parskip}{0pt}

\setlist[enumerate,1]{leftmargin=0pt, itemindent=\parindent, labelsep=0.5em, itemsep=0pt, parsep=0pt, topsep=0pt}
\setlist[enumerate,2]{label=\arabic{enumi}.\arabic*,leftmargin=0pt, itemindent=1in, labelsep=0.3em, itemsep=0pt, parsep=0pt, topsep=0pt}


% Fix indentation after section headings
\makeatletter
\@afterindenttrue
\makeatother

% Hyperlinks in PDF and make Table of Contents entries clickable
% Load hyperref as late as possible to avoid package clashes
\usepackage[unicode=true,breaklinks=true]{hyperref}
\hypersetup{
  linktoc=all, % make both titles and page numbers in the TOC clickable
  unicode=true,
  pdftitle={THESIS TITLE IN ENGLISH},
  pdfauthor={NAME SURNAME},
  colorlinks=true,
  linkcolor=black,
  citecolor=black,
  urlcolor=black
}


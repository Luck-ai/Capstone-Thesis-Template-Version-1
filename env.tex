\usepackage{fontspec}
\setmainfont{TH SarabunPSK}

\fontsize{16pt}{19.2pt}\selectfont

\usepackage{amsmath, amssymb}
\usepackage{enumitem}
\usepackage{indentfirst}

\usepackage{geometry}
\geometry{
    a4paper,
    left=1.5in,
    right=1in,
    top=1in,
    bottom=1in
}

\usepackage{graphicx}
\usepackage{float}
\usepackage{caption}

% \captionsetup[table]{labelsep=space,justification=centering,font=bf}
% \captionsetup[figure]{labelsep=space,justification=centering,font=bf}

% Headers and spacing
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\rhead{\thepage}
\renewcommand{\headrulewidth}{0pt}
\usepackage{setspace}
\onehalfspacing

% Section title formatting
\usepackage{titlesec}

\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{3}

\titleformat{\chapter}[display]
  {\normalfont\bfseries\centering\fontsize{18}{22}\selectfont}
  {\MakeUppercase{\chaptertitlename\ \thechapter}}
  {1pt}
  {\fontsize{18}{22}\selectfont}

\titlespacing*{\chapter}{0pt}{0pt}{0pt}

\titleformat{\section}
  {\normalfont\bfseries\fontsize{16}{20}\selectfont}
  {\thesection}
  {1em}
  {\MakeUppercase{\fontsize{16}{20}\selectfont}}
\titlespacing*{\section}{0pt}{1em}{0pt}

\titleformat{\subsection}
  {\normalfont\bfseries\fontsize{16}{20}\selectfont}
  {\hspace{1in}\thesubsection}
  {1em}
  {\fontsize{16}{20}\selectfont}
\titlespacing*{\subsection}{0pt}{0pt}{0pt}

\titleformat{\subsubsection}
  {\normalfont\bfseries\fontsize{16}{20}\selectfont}
  {\hspace{1.5in}\thesubsubsection}
  {1em}
  {\fontsize{16}{20}\selectfont}
\titlespacing*{\subsubsection}{0pt}{0pt}{0pt}

% Table of contents formatting
\usepackage{tocloft}
\renewcommand{\cftchapfont}{\bfseries}
\renewcommand{\cftsecfont}{\bfseries}
\renewcommand{\cftchappagefont}{\bfseries}
\renewcommand{\cftsecpagefont}{\bfseries}
\renewcommand{\cftchapleader}{\cftdotfill{\cftdotsep}}

% Numbering
\numberwithin{equation}{chapter}

% Force paragraph indentation
\setlength{\parindent}{1in}
\setlength{\parskip}{0pt}

\setlist[enumerate,1]{leftmargin=1.2in, itemindent=0pt, labelsep=0.5em, itemsep=0pt, parsep=0pt, topsep=0pt}
\setlist[enumerate,2]{label=\arabic{enumi}.\arabic*,leftmargin=0pt, itemindent=1.3em, labelsep=0.3em, itemsep=0pt, parsep=0pt, topsep=0pt}


% Fix indentation after section headings
\makeatletter
\@afterindenttrue
\makeatother

